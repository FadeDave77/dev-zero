"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = {
    async end(giveawayRepo, msg) {
        await msg.fetch();
        giveawayRepo.delete({ message: msg.id });
        const reaction = await msg.reactions.cache.filter(r => r.emoji.name === 'ðŸŽ‰').first().fetch();
        await reaction.users.fetch();
        const winner = reaction.users.cache.filter(w => !w.bot).random();
        const item = msg.embeds[0].author.name.split('| ').slice(1);
        const embed = msg.embeds[0];
        embed.setFooter('Giveaway has ended.')
            .setColor(0xff0000)
            .addField('Winner:', winner ? `${winner} (${winner.tag})` : 'No winners :cry:');
        msg.edit(embed);
        if (winner)
            msg.channel.send(`Giveaway has ended for the item **${item}**, the winner is: ${winner} (${winner.tag})`);
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2l2ZWF3YXltYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3N0cnVjdHVyZXMvZ2l2ZWF3YXltYW5hZ2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBS0Esa0JBQWU7SUFDWCxLQUFLLENBQUMsR0FBRyxDQUFDLFlBQW1DLEVBQUUsR0FBWTtRQUN2RCxNQUFNLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNsQixZQUFZLENBQUMsTUFBTSxDQUFDLEVBQUUsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFLEVBQUMsQ0FBQyxDQUFDO1FBRXhDLE1BQU0sUUFBUSxHQUFvQixNQUFNLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQy9HLE1BQU0sUUFBUSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM3QixNQUFNLE1BQU0sR0FBUyxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUV2RSxNQUFNLElBQUksR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUMzRCxNQUFNLEtBQUssR0FBaUIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxQyxLQUFLLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDO2FBQ3JDLFFBQVEsQ0FBQyxRQUFRLENBQUM7YUFDbEIsUUFBUSxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxLQUFLLE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUNoRixHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRWhCLElBQUksTUFBTTtZQUFFLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLHFDQUFxQyxJQUFJLHNCQUFzQixNQUFNLEtBQUssTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUE7SUFDekgsQ0FBQztDQUNKLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNZXNzYWdlLCBNZXNzYWdlRW1iZWQsIE1lc3NhZ2VSZWFjdGlvbiwgVXNlciB9IGZyb20gJ2Rpc2NvcmQuanMnO1xuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgR2l2ZWF3YXlzIH0gZnJvbSAnLi4vbW9kZWxzL2dpdmVhd2F5cyc7XG5pbXBvcnQgeyBlbmRpYW5uZXNzIH0gZnJvbSAnb3MnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgYXN5bmMgZW5kKGdpdmVhd2F5UmVwbzogUmVwb3NpdG9yeTxHaXZlYXdheXM+LCBtc2c6IE1lc3NhZ2UpIHtcbiAgICAgICAgYXdhaXQgbXNnLmZldGNoKCk7XG4gICAgICAgIGdpdmVhd2F5UmVwby5kZWxldGUoeyBtZXNzYWdlOiBtc2cuaWR9KTtcblxuICAgICAgICBjb25zdCByZWFjdGlvbjogTWVzc2FnZVJlYWN0aW9uID0gYXdhaXQgbXNnLnJlYWN0aW9ucy5jYWNoZS5maWx0ZXIociA9PiByLmVtb2ppLm5hbWUgPT09ICfwn46JJykuZmlyc3QoKS5mZXRjaCgpO1xuICAgICAgICBhd2FpdCByZWFjdGlvbi51c2Vycy5mZXRjaCgpO1xuICAgICAgICBjb25zdCB3aW5uZXI6IFVzZXIgPSByZWFjdGlvbi51c2Vycy5jYWNoZS5maWx0ZXIodyA9PiAhdy5ib3QpLnJhbmRvbSgpO1xuXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBtc2cuZW1iZWRzWzBdLmF1dGhvci5uYW1lLnNwbGl0KCd8ICcpLnNsaWNlKDEpXG4gICAgICAgIGNvbnN0IGVtYmVkOiBNZXNzYWdlRW1iZWQgPSBtc2cuZW1iZWRzWzBdO1xuICAgICAgICBlbWJlZC5zZXRGb290ZXIoJ0dpdmVhd2F5IGhhcyBlbmRlZC4nKVxuICAgICAgICAuc2V0Q29sb3IoMHhmZjAwMDApXG4gICAgICAgIC5hZGRGaWVsZCgnV2lubmVyOicsIHdpbm5lciA/IGAke3dpbm5lcn0gKCR7d2lubmVyLnRhZ30pYCA6ICdObyB3aW5uZXJzIDpjcnk6Jyk7XG4gICAgICAgIG1zZy5lZGl0KGVtYmVkKTtcblxuICAgICAgICBpZiAod2lubmVyKSBtc2cuY2hhbm5lbC5zZW5kKGBHaXZlYXdheSBoYXMgZW5kZWQgZm9yIHRoZSBpdGVtICoqJHtpdGVtfSoqLCB0aGUgd2lubmVyIGlzOiAke3dpbm5lcn0gKCR7d2lubmVyLnRhZ30pYClcbiAgICB9XG59XG4iXX0=